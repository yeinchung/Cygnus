<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>NA • Cygnus</title><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="NA"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">Cygnus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="articles/examples.html">Guided Tutorial</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-full-manual" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Full Manual</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-full-manual"><li><a class="dropdown-item" href="articles/data_in_out.html">Data Input and Output</a></li>
    <li><a class="dropdown-item" href="articles/marker_dist.html">Marker Intensity Distribution Modifications</a></li>
    <li><a class="dropdown-item" href="articles/marker_co.html">Marker Colocalization and Correlation</a></li>
    <li><a class="dropdown-item" href="articles/dim_red.html">Dimensionality Reduction</a></li>
    <li><a class="dropdown-item" href="articles/clustering.html">EV Heterogeneity</a></li>
    <li><a class="dropdown-item" href="articles/make_report.html">On-demand Report Generation</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yeinchung/Cygnus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>NA</h1>
      <small class="dont-index">Source: <a href="https://github.com/yeinchung/Cygnus/blob/master/examples.md" class="external-link"><code>examples.md</code></a></small>
    </div>

<div class="section level2">
<h2 id="cygnus-example-analysis---a-quick-tutorial">Cygnus Example Analysis - A Quick Tutorial<a class="anchor" aria-label="anchor" href="#cygnus-example-analysis---a-quick-tutorial"></a></h2>
<p>This tutorial covers reading a processed input file from AIVIA to generate an example report and 3D plots required for interactive data visualization. The instructions for package installation can be found <a href="https://yeinchung.github.io/Cygnus/">here</a>.</p>
<p>For the purpose of this tutorial, we will be using an example data from KP1.9 cell line derived extracellular vesicle imaging data. The data can be downloaded here.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yeinchung/Cygnus" class="external-link">Cygnus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span></code></pre></div>
<p>Creating Cygnus object requires the user to specify metadata and markers column from the input .csv file. This can be done through an interactive Shiny App.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data.path</span> <span class="op">&lt;-</span> <span class="st">"../inst/extdata/all_cells.csv"</span> </span>
<span><span class="co"># cyg &lt;- CreateCygnus(data.path) # this starts the interactive app</span></span>
<span></span>
<span><span class="va">cyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CreateCygnus.html">CreateCygnus</a></span><span class="op">(</span><span class="va">data.path</span>,</span>
<span>                    markers_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PanEV"</span>, <span class="st">"EpCAM"</span>, <span class="st">"MET"</span>,</span>
<span>                                    <span class="st">"SDC1"</span>, <span class="st">"EGFR"</span>, <span class="st">"ADAM10"</span>,</span>
<span>                                    <span class="st">"CTSH"</span>, <span class="st">"PDL1"</span>, <span class="st">"HER2"</span> <span class="op">)</span>,</span>
<span>                    meta_col <span class="op">=</span> <span class="st">"celltype"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cyg</span></span></code></pre></div>
<pre><code><span><span class="co">## Summary of CygnusObject:</span></span>
<span><span class="co">## Slot: [1] "Raw_Score"</span></span>
<span><span class="co">## Numer of EVs: [1] 3264</span></span></code></pre>
<p>If any metadata from another file need to be added, you can do so with the following code:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cyg</span><span class="op">@</span><span class="va">ev_meta</span><span class="op">[[</span><span class="st">'type'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"cell_line"</span></span></code></pre></div>
<p>Cygnus allows iterative analysis, where the results from each step of analysis is stored in the same object. This is especially useful for data sharing.</p>
<p>Currently, the object has one matrix, “Raw_Score”, which is the default matrix that stores the initial input matrix of the CygnusObject. The object contains 755 EVs. Please note that Cygnus is a scalable workflow, and can run with samples with &gt;10,000 EVs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotDistribution.html">plotDistribution</a></span><span class="op">(</span><span class="va">cyg</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4"><div class="figcaption">plot of chunk unnamed-chunk-4</div>
</div>
<p>From the above distribution, you can see that the range of intensities of markers differ. Sometimes this difference arises from differences in antibody affinity, rather than reflecting a meaningful biological signal. Therefore, we offer an optional function that creates another layer to scale the expressions.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/scaleExpressionMatrix.html">scaleExpressionMatrix</a></span><span class="op">(</span><span class="va">cyg</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plotDistribution.html">plotDistribution</a></span><span class="op">(</span><span class="va">cyg</span>, matrix <span class="op">=</span> <span class="st">"scaled_exp_matrix"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-5-1.png" alt="plot of chunk unnamed-chunk-5"><div class="figcaption">plot of chunk unnamed-chunk-5</div>
</div>
<p>PanEV is used to localize EVs in the original imaging data, and is generally not useful for biological interpretation. However, EVs with greater PanEV expression may be larger in size. This can lead to EVs with greater size aggregating together when clustered. This function also adds a new matrix to the object, which can be viewed with <em>names(<a href="mailto:cyg@matrices" class="email">cyg@matrices</a>)</em>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/normalizeByPanEV.html">normalizeByPanEV</a></span><span class="op">(</span><span class="va">cyg</span>, <span class="st">"PanEV"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="reference/plotDistribution.html">plotDistribution</a></span><span class="op">(</span><span class="va">cyg</span>, matrix <span class="op">=</span> <span class="st">"normalized_exp_mat"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6"><div class="figcaption">plot of chunk unnamed-chunk-6</div>
</div>
<p>Another normalization method uses the distribution of IgG (isotype control). This can be done with an interactive Shiny app.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># NEED TO BE UPDATED</span></span></code></pre></div>
<p>This sets arbitrary cutoff</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createBinaryMatrix.html">createBinaryMatrix</a></span><span class="op">(</span><span class="va">cyg</span>, thresholds <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plotDistribution.html">plotDistribution</a></span><span class="op">(</span><span class="va">cyg</span>, matrix <span class="op">=</span> <span class="st">"binary_exp_matrix"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8"><div class="figcaption">plot of chunk unnamed-chunk-8</div>
</div>
<p><strong>Description of average heatmap</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotAvgHeatmap.html">plotAvgHeatmap</a></span><span class="op">(</span><span class="va">cyg</span>, <span class="st">"celltype"</span>, scale <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-9-1.png" alt="plot of chunk unnamed-chunk-9"><div class="figcaption">plot of chunk unnamed-chunk-9</div>
</div>
<div class="section level3">
<h3 id="marker-analysis">Marker Analysis<a class="anchor" aria-label="anchor" href="#marker-analysis"></a></h3>
<p><strong>ADD DESCRIPTIONS</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># co localization (show venn and upset)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># customizing upset</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pairwise .....</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devience</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># upset plot</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ev-analysis">EV Analysis<a class="anchor" aria-label="anchor" href="#ev-analysis"></a></h3>
<p><strong>ADD DESCRIPTIONS</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/markRelevantMarkers.html">markRelevantMarkers</a></span><span class="op">(</span><span class="va">cyg</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EpCAM"</span>, <span class="st">"MET"</span>,</span>
<span>                               <span class="st">"SDC1"</span>, <span class="st">"EGFR"</span>, <span class="st">"ADAM10"</span>,</span>
<span>                               <span class="st">"CTSH"</span>, <span class="st">"PDL1"</span>, <span class="st">"HER2"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/runPCA.html">runPCA</a></span><span class="op">(</span><span class="va">cyg</span>, matrix_name <span class="op">=</span> <span class="st">"Raw_Score"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="reference/plotPCA.html">plotPCA</a></span><span class="op">(</span><span class="va">cyg</span>, color_by <span class="op">=</span> <span class="st">"celltype"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-16-1.png" alt="plot of chunk unnamed-chunk-16"><div class="figcaption">plot of chunk unnamed-chunk-16</div>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotElbowPlot.html">plotElbowPlot</a></span><span class="op">(</span><span class="va">cyg</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-18-1.png" alt="plot of chunk unnamed-chunk-18"><div class="figcaption">plot of chunk unnamed-chunk-18</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yein Chung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

